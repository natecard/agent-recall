{
  "project": "Agent Recall Super Ralph",
  "version": 2,
  "selection_policy": {
    "agent_decides_priority": true,
    "priority_scale": "1 = highest priority",
    "order_of_operations": [
      "critical bugfixes",
      "tracer-bullet feature slices",
      "polish and quick wins",
      "refactors"
    ]
  },
  "items": [
    {
      "id": "AR-1012",
      "priority": 1,
      "title": "Compaction Backend Choice (LLM or Coding CLI)",
      "description": "Add a compaction backend setting so users can run compaction summarization through the coding CLI agent instead of only the configured LLM provider.",
      "user_story": "As a user, I want to choose whether compaction summarization uses the configured LLM provider or my coding CLI agent so I can keep behavior consistent with my workflow.",
      "steps": [
        "[DONE] Add compaction backend config with values llm and coding_cli.",
        "[DONE] Keep llm as the default backend for backward compatibility.",
        "[DONE] Implement coding_cli backend execution for compact synthesis paths.",
        "[DONE] Validate coding_cli output shape before writing tier files.",
        "[DONE] Add tests for backend selection and fallback behavior."
      ],
      "acceptance_criteria": [
        "Users can select compaction backend via config.",
        "Default behavior stays unchanged when config is not set.",
        "Compaction can run using coding_cli backend when configured.",
        "Invalid coding_cli output does not corrupt tier files."
      ],
      "validation_commands": [
        "uv run pytest tests/test_compact.py -q"
      ],
      "passes": true
    },
    {
      "id": "AR-1013",
      "priority": 1,
      "title": "Auto-Mark Completed PRD Steps as [DONE]",
      "description": "Ensure Ralph loop marks each completed step in PRD items with a [DONE] prefix when an item is completed, not only passes: true.",
      "user_story": "As a user handing off between agents, I want completed steps clearly marked in the PRD so the next agent can quickly see exactly what has already been done.",
      "steps": [
        "[DONE] Add loop-side normalization that updates steps for passed items.",
        "[DONE] Prefix each completed step string with [DONE] if missing.",
        "[DONE] Avoid double-prefixing steps already marked [DONE].",
        "[DONE] Run this normalization each iteration before next prompt context.",
        "[DONE] Add regression test for step-marking behavior."
      ],
      "acceptance_criteria": [
        "When an item has passes: true, its steps are marked with [DONE].",
        "Existing [DONE] steps are not double-prefixed.",
        "Next iteration prompt includes updated PRD step status."
      ],
      "validation_commands": [
        "uv run pytest tests/test_ralph_loop.py -q"
      ],
      "passes": true
    }
  ]
}
