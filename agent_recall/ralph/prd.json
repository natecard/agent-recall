{
  "project": "Agent Recall Super Ralph",
  "version": 2,
  "selection_policy": {
    "agent_decides_priority": true,
    "priority_scale": "1 = highest priority",
    "order_of_operations": [
      "critical bugfixes",
      "tracer-bullet feature slices",
      "polish and quick wins",
      "refactors"
    ]
  },
  "items": [
    {
      "id": "AR-108",
      "title": "TUI: Remove CLI Commands from Command Palette",
      "type": "polish",
      "priority": 1,
      "description": "The Command Palette currently lists raw CLI commands. Selecting them or typing them often results in errors like 'Commands must start with /', which is confusing. These should be removed to streamline the experience.",
      "requirements": [
        "[DONE] Remove the 'CLI Commands' section from the Command Palette logic.",
        "[DONE] Ensure only valid TUI actions or slash commands are actionable from the palette.",
        "[DONE] Fix the issue where selecting a command triggers a validation error about missing slash prefix."
      ],
      "acceptance_criteria": [
        "[DONE] Command Palette no longer shows a 'CLI Commands' group.",
        "[DONE] Selecting any remaining action works immediately.",
        "[DONE] Typing a slash command works as expected."
      ],
      "passes": true
    },
    {
      "id": "AR-104",
      "title": "TUI: Unified History & Diff View",
      "type": "feature",
      "priority": 2,
      "description": "Currently, there are disparate views for diffs ('Diff View', 'View Last Diff'). These should be consolidated into a single 'History' or 'Iterations' view that allows navigating through past Ralph iterations and viewing their respective diffs.",
      "requirements": [
        "[DONE] Combine 'Diff View' and 'View Last Diff' functionality.",
        "[DONE] Implement navigation controls (Previous/Next Iteration) to browse history.",
        "[DONE] Display the diff summary and file details for the selected iteration.",
        "[DONE] Ensure the view state persists or resets logically when switching views."
      ],
      "acceptance_criteria": [
        "[DONE] User can view a history of Ralph iterations.",
        "[DONE] User can navigate backwards and forwards through the commit/iteration list.",
        "[DONE] Selecting an iteration shows its diff and details.",
        "[DONE] Redundant diff views are removed from the Command Palette and UI."
      ],
      "passes": true
    },
    {
      "id": "AR-106",
      "title": "TUI: Fix Banner Flashing",
      "type": "bugfix",
      "priority": 1,
      "description": "The dashboard banner flashes every few seconds (likely on the refresh interval), indicating unnecessary full re-renders of the component or the entire dashboard.",
      "requirements": [
        "[DONE] Investigate the `_refresh_dashboard_panel` and `_update_dashboard_widgets` logic.",
        "[DONE] Ensure that simple time updates in the banner do not trigger a full dashboard tear-down and re-mount.",
        "[DONE] Optimize the Banner widget to update its content (text) in-place without replacing the widget itself.",
        "[DONE] Verify that `_update_dashboard_widgets` returns `True` for routine updates."
      ],
      "acceptance_criteria": [
        "[DONE] The banner time updates smoothly without flashing.",
        "[DONE] The rest of the dashboard remains stable during time updates.",
        "[DONE] CPU usage for TUI idle state is minimized."
      ],
      "passes": true
    },
    {
      "id": "AR-105",
      "title": "TUI: Fix Layout Customization",
      "type": "polish",
      "priority": 3,
      "description": "The current layout customization options (visibility toggles) are confusing, do not reflect the actual current state of the UI, and do not offer meaningful control over the layout structure.",
      "requirements": [
        "[DONE] Ensure the 'Customise Layout' modal pre-populates with the *actual* current widget visibility and banner settings.",
        "[DONE] Verify that applying changes immediately reflects in the dashboard without requiring a full reload or manual refresh.",
        "[DONE] Ensure layout settings persist correctly across sessions.",
        "[SKIPPED] Refactor layout options to be more intuitive, possibly introducing 'View Modes' (e.g., Focus, Overview, Debug) instead of just raw toggles - deferred as UX enhancement."
      ],
      "acceptance_criteria": [
        "[DONE] Opening layout settings shows the correct current state.",
        "[DONE] Changes to layout settings are applied immediately and visibly.",
        "[DONE] Layout options are clear and easier to understand for the user."
      ],
      "passes": true
    },
    {
      "id": "AR-107",
      "title": "TUI: Fix Command Palette Truncation",
      "type": "bugfix",
      "priority": 2,
      "description": "The Command Palette currently truncates the list of commands in each section (e.g., showing only 5 items). Users need to see the full list of available commands.",
      "requirements": [
        "[DONE] Remove the arbitrary limit (e.g., 5 items) on command groups in the Command Palette.",
        "[DONE] Allow the `OptionList` to handle scrolling if the list is long.",
        "[DONE] Ensure all available commands for each section are rendered and accessible."
      ],
      "acceptance_criteria": [
        "[DONE] The Command Palette shows all commands in each section.",
        "[DONE] No '... X more' truncation text is visible unless explicitly desired for very large lists (but prefer scroll).",
        "[DONE] Users can scroll through the entire command list."
      ],
      "passes": true
    },
    {
      "id": "AR-108",
      "title": "TUI: Remove CLI Commands from Command Palette",
      "type": "polish",
      "priority": 2,
      "description": "The Command Palette currently lists raw CLI commands. Selecting them or typing them often results in errors like 'Commands must start with /', which is confusing. These should be removed to streamline the experience.",
      "requirements": [
        "[DONE] Remove the 'CLI Commands' section from the Command Palette logic.",
        "[DONE] Ensure only valid TUI actions or slash commands are actionable from the palette.",
        "[DONE] Fix the issue where selecting a command triggers a validation error about missing slash prefix."
      ],
      "acceptance_criteria": [
        "[DONE] Command Palette no longer shows a 'CLI Commands' group.",
        "[DONE] Selecting any remaining action works immediately.",
        "[DONE] Typing a slash command works as expected."
      ],
      "passes": true
    },
    {
      "id": "AR-109",
      "title": "TUI: Command Palette Cleanup & Consolidation",
      "type": "polish",
      "priority": 1,
      "description": "Review and consolidate existing Command Palette commands. Remove redundant actions, clarify 'Recent' vs. 'Suggested', and consider removing/re-evaluating OpenCode plugin, Claude Code Hooks, Watch Claude Logs, Source Health, and the Views list.",
      "requirements": [
        "Audit 'palette_actions.py' and 'palette_router.py' for redundant or obsolete commands.",
        "Evaluate necessity of 'OpenCode plugin', 'Claude Code Hooks', 'Watch Claude Logs', 'Source Health', and 'Views' list.",
        "Remove commands that are not explicitly required to streamline the palette.",
        "Ensure 'Recent' properly saves and surfaces recently used acceptable commands instead of pushing out generic 'Suggested' commands without context."
      ],
      "acceptance_criteria": [
        "Command Palette list is significantly smaller and more focused.",
        "No overlap in command functionality.",
        "Obsolete integrations (if determined) are removed from the palette."
      ],
      "passes": false
    },
    {
      "id": "AR-110",
      "title": "TUI: Fix Arrow Key Navigation in Select PRD Modal",
      "type": "bugfix",
      "priority": 1,
      "description": "The up and down arrow keys do not function as expected in the 'Select PRD' modal (`prd_select.py`).",
      "requirements": [
        "[DONE] Implement `on_key` event handler in `PRDSelectModal` to capture 'up' and 'down' key presses.",
        "[DONE] Route the arrow key events to modify the `highlighted` index of the `OptionList` (`#prd_select_list`), similar to the implementation in the Command Palette.",
        "[DONE] Ensure scrolling works seamlessly through the PRD options."
      ],
      "acceptance_criteria": [
        "User can navigate the PRD list using up and down arrow keys.",
        "The selected/highlighted item updates visually."
      ],
      "passes": true
    },
    {
      "id": "AR-111",
      "title": "TUI: Enhance Iteration Diff Viewer UI",
      "type": "feature",
      "priority": 2,
      "description": "The Iteration Diff Viewer needs UI improvements: the file tree panel should be resizable, and the title must display the current iteration or commit information to provide context.",
      "requirements": [
        "Add a resizable handle or integrate a `Splitter` component between the `DiffTreeViewer` and the content view.",
        "Update `IterationDetailModal` or the diff viewer component to accept and display the iteration identifier/title in its header.",
        "Ensure CSS supports layout changes for a resizable tree."
      ],
      "acceptance_criteria": [
        "User can drag the boundary between the file tree and diff content to resize it.",
        "The top of the viewer clearly states which iteration/commit is being viewed."
      ],
      "passes": false
    },
    {
      "id": "AR-112",
      "title": "TUI: Fix Layout Widget Visibility Persistence",
      "type": "bugfix",
      "priority": 1,
      "description": "When configuring the layout via the Layout Customiser, unchecking widgets (like terminal/console) causes the remaining active widgets to fail to render properly or be pushed out of view.",
      "requirements": [
        "Investigate `_build_overview_layout` in `dashboard.py` and `_mount_dashboard_widgets` in `app.py`.",
        "Ensure that when a layout changes, the terminal panel or other components do not aggressively consume infinite space (`1fr`), forcing other panels to collapse.",
        "Ensure `dashboard_all_grid` and `dashboard_overview_row` structures handle missing child panels gracefully."
      ],
      "acceptance_criteria": [
        "Toggling widgets off correctly reallocates space to remaining visible widgets.",
        "Toggling widgets on makes them appear immediately without breaking the layout.",
        "The console/terminal does not unfairly consume all available screen real estate when other panels are active."
      ],
      "passes": false
    },
    {
      "id": "AR-113",
      "title": "TUI: Consolidate Sessions and Source Health Views",
      "type": "feature",
      "priority": 1,
      "description": "The 'Source Health' and 'Sessions' views provide overlapping utility. We need to merge the display of sources into the 'Sessions' view to create a unified 'Browse Data' experience, eliminating the need for a separate 'Sources' view.",
      "requirements": [
        "Incorporate the 'InteractiveSourcesWidget' (or its data/functionality) into the 'SessionRunModal' or the main 'sessions' view.",
        "Ensure users can still see source availability and initiate syncs from this unified view.",
        "Remove the independent 'sources' command/view entirely once functionality is merged."
      ],
      "acceptance_criteria": [
        "The Sessions view displays both conversation history and connected sources status.",
        "Users can sync sources directly from the Sessions view.",
        "The standalone 'view:sources' or 'sources' command is no longer necessary or accessible."
      ],
      "passes": false
    },
    {
      "id": "AR-114",
      "title": "TUI: Standardize CSS Spacing",
      "type": "polish",
      "priority": 2,
      "description": "Make the CSS consistent across the entire TUI. Standardize spacing, padding, margin, and gaps to use one of 3 values: 2, 4, 8. Use simple class names for these and apply them consistently across all files containing CSS styling.",
      "requirements": [
        "Define simple CSS classes for spacing values 2, 4, and 8 (e.g., .p-2, .m-4, .gap-8).",
        "Audit all TUI Python files and CSS files for hardcoded spacing values and replace them with the standard classes/values.",
        "Ensure consistent padding, margin, and gap usage across all TUI components."
      ],
      "acceptance_criteria": [
        "All spacing (padding, margin, gap) in the TUI uses the standardized values of 2, 4, or 8.",
        "Simple, standardized class names are used for spacing.",
        "No visual regressions introduced by the CSS standardization."
      ],
      "passes": false
    }
  ]
}
